<!doctype html>
<html lang="en" class="no-js">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Fixed positions with JavaScript</title>
	<meta name="description" content="Lead UX Designer at Topguest. My blog, portfolio etc.">
	<meta name="author" content="Nathan McGinness">
	
	<meta name="viewport" content="width=device-width, initial-scale=auto">
	
	<link rel="shortcut icon" type="image/png" href="/favicon.png">
	
	<link rel="stylesheet" href="/stylesheets/compiled/base.css?v=2">
	<link href="http://feeds.feedburner.com/njmcgee" type="application/atom+xml" rel="alternate" title="Nathan McGinness" />
	
	<script type="text/javascript" src="http://use.typekit.com/atw0rqs.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

</head>
<body>
	<div id="container" class="container_24">
	  <div class="grid_24">
  		<header>
        <h1><a href="/">Nathan McGinness</a></h1>
  		</header>
  		<div id="sidebar" class="grid_5">
  		  <div id="fixed" class="grid_5">
      		<nav id="main-nav">
      		  <ul>
      		    
                <li><a href="/">Blog</a></li>
              
              
                <li><a href="/about.html">About</a></li>
              
              
                <li><a href="/work.html">Work</a></li>
                 
    		      <li><a href="mailto:nathanmcginness@gmail.com">Contact</a></li>
      		  </ul>    		  
      		</nav>
      		<p>I love design, technology, pixels, grids, data, type &amp; language. I get to play with all of these things at <a href="http://topguest.com">Topguest</a> where I&rsquo;m the lead UX designer.</p>
      		<nav id="elsewhere">
      		  <ul>
    		      <li><a href="http://www.linkedin.com/pub/nathan-mcginness/3/b2a/800">Linkedin</a></li>
    		      <li><a href="http://www.last.fm/user/njmcgee">Last.fm</a></li>
    		      <li><a href="https://twitter.com/#!/njmcgee">Twitter</a></li>
    		      <li><a href="http://www.flickr.com/photos/njmcgee/">Flickr</a></li>
    		      <li><a href="http://www.delicious.com/njmcgee">Delicious</a></li>
    		      <li><a href="https://github.com/njmcgee">Github</a></li>
    		      <li><a href="http://njmcgee.tumblr.com">Tumblr</a></li>
    		      <li><a href="http://dribbble.com/njmcgee">Dribbble</a></li>
      		  </ul>    		  
      		</nav>
    		</div>
    	</div>
		  <div id="main" role="main" class="grid_17 alpha">
		    <article id="post">
  <span class="date grid_3 alpha">08 June 2011</span> 
  <h1 class="grid_14 omega">
    Fixed positions with JavaScript
  </h1>
  
  <div class="clear"></div>
  <div id="post-body">
    <p>Fixed elements (sidebars in particular) are <a href="http://help.bigcartel.com/articles/22-javascript-ajax">becoming</a> <a href="http://store.apple.com/us/configure/MC723LL/A?mco=MjEyOTY4OTQ">popular</a>. You know those sidebars that wait until the top of window hits them, and they magically stick?</p>
<p>In simple situations (this site for example) <span class="caps">CSS</span> will do the trick. But what if dynamic content at the top of your page changes this calculation (a flash or notification message for example)? Or your header likes to change size?</p>
<p><a href="http://ozanonay.com">Ozan</a> helped me solve this problem, and I thought I&#8217;d share.</p>
<p>We’ll start by selecting said element, calling our custom function, and specifying how far from the top of the page we want it to live (before scrolling).</p>
<div class="highlight"><pre><code class="js"><span class="kd">var</span> <span class="nx">topBoundary</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#fixed&#39;</span><span class="p">).</span><span class="nx">myFixture</span><span class="p">({</span> <span class="nx">topBoundary</span><span class="o">:</span> <span class="nx">topBoundary</span> <span class="p">});</span>
</code></pre>
</div><p>And our function looks something like this:</p>
<div class="highlight"><pre><code class="js"><span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">myFixture</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    
    <span class="kd">var</span> <span class="nx">elem</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="s1">&#39;fixed&#39;</span><span class="p">);</span>
    
    <span class="kd">var</span> <span class="nx">setPosition</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>         
      <span class="c1">// get no of pixels hidden above the the window     </span>
      <span class="kd">var</span> <span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">();</span>       
      <span class="c1">// set the default position</span>
      <span class="kd">var</span> <span class="nx">top</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">top</span> <span class="o">||</span> <span class="mi">0</span>      
        <span class="c1">// The difference between the default position and how far we have scrolled</span>
        <span class="p">,</span> <span class="nx">topBuffer</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">topBoundary</span> <span class="o">-</span> <span class="nx">scrollTop</span><span class="p">;</span>      
      <span class="c1">// update position if required</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">topBuffer</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nx">top</span> <span class="o">+=</span> <span class="nx">topBuffer</span> <span class="p">}</span>
      <span class="c1">// Set the position!</span>
      <span class="nx">elem</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="nx">top</span><span class="p">);</span>
    <span class="p">};</span>
        
    <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;scroll&#39;</span><span class="p">,</span> <span class="nx">setPosition</span><span class="p">);</span>
    <span class="nx">setPosition</span><span class="p">();</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre>
</div><p>Let’s revisit our first block of code, and base the calculation on the height of a div above it (a header for example):</p>
<div class="highlight"><pre><code class="js"><span class="kd">var</span> <span class="nx">headerHeight</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;header&#39;</span><span class="p">);</span>
<span class="nx">topBoundary</span> <span class="o">=</span> <span class="nx">headerHeight</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">();</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#fixed&#39;</span><span class="p">).</span><span class="nx">myFixture</span><span class="p">({</span> <span class="nx">topBoundary</span><span class="o">:</span> <span class="nx">topBoundary</span> <span class="p">});</span>
</code></pre>
</div><p>Let&#8217;s also check if any notifications exist, and account for that:</p>
<div class="highlight"><pre><code class="js"><span class="kd">var</span> <span class="nx">notifications</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#notifications&#39;</span><span class="p">)</span>
  <span class="p">,</span> <span class="nx">headerHeight</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;header&#39;</span><span class="p">)</span>
  <span class="p">,</span> <span class="nx">topBoundary</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">topBoundary</span> <span class="o">=</span> <span class="nx">notifications</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">+</span> <span class="nx">headerHeight</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nx">topBoundary</span> <span class="o">=</span> <span class="nx">headerHeight</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#fixed&#39;</span><span class="p">).</span><span class="nx">myFixture</span><span class="p">({</span> <span class="nx">topBoundary</span><span class="o">:</span> <span class="nx">topBoundary</span> <span class="p">});</span>
</code></pre>
</div>
  </div>
  <div class="clear"></div>
</div>
		  </div>
		  <div class="clear"></div>
		  <footer>
		    <p id="fine-print">Hosted by <a href="https://github.com/njmcgee/njmcgee.github.com">Github</a> and powered by <a href="https://github.com/mojombo/jekyll">Jekyll</a>. Licensed under the <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons attribution license</a>.</p>
		  </footer>
		</div>
	</div>

	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
	<script>!window.jQuery && document.write(unescape('%3Cscript src="js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
	<script src="/js/plugins.js"></script>
	<script src="/js/script.js"></script>
	
	<script>
		var _gaq=[['_setAccount','UA-3517986-8'],['_trackPageview']]; // Change UA-XXXXX-X to be your site's ID
		(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
		g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
		s.parentNode.insertBefore(g,s)}(document,'script'));
	</script>
</body>
</html>